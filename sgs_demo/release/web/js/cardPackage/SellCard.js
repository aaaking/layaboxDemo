var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])};return function(n,i){function e(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}}(),SellCard=function(t){function n(){var n=t.call(this)||this;return n._mask.on(Laya.Event.CLICK,n,n.onTouch),n._btnClose.on(Laya.Event.CLICK,n,n.onTouch),n._btnConfirm.on(Laya.Event.CLICK,n,n.onTouch),n}return __extends(n,t),Object.defineProperty(n,"instance",{get:function(){return this._instance||(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.prototype.show=function(t,i){t&&!n.instance.parent&&t.addChild(n.instance),this._data=i,this._imgIcon.skin="cards/"+this._data.cfg.icon+".png",this._input.text="",this._labTip.visible=this._boxWaiting.visible=!1,this._boxNormal.mouseEnabled=!0,Laya.Tween.clearTween(this._labTip),Laya.Tween.clearTween(this._boxWaiting),Laya.timer.clearAll(this),this.onResize(null)},n.prototype.onTouch=function(t){switch(t.currentTarget){case this._btnClose:this.removeSelf();break;case this._btnConfirm:this.sell()}},n.prototype.onResize=function(t){void 0===t&&(t=null),this.width=Laya.stage.width,this.height=Laya.stage.height},n.prototype.sell=function(){var t=this,n="0000000000000000000000000000000000000000000000000000000000000000";if(""==this._input.text)Laya.Tween.clearTween(this._labTip),this._labTip.visible=!0,this._labTip.alpha=0,Laya.Tween.to(this._labTip,{alpha:1},500,null,Laya.Handler.create(this,function(){Laya.Tween.to(t._labTip,{alpha:0},500,null,null,1e3)}));else{this._boxNormal.mouseEnabled=!1,this._boxWaiting.visible=!0,this._boxWaiting.alpha=0;var i=parseInt(this._input.text);console.log(this._data.id.toString(16)),console.log(i.toString(16).length),console.log(n.substring(0,64-this._data.id.toString(16).length)+this._data.id.toString(16));var e=n.substring(0,64-this._data.id.toString(16).length)+this._data.id.toString(16);console.log(i.toString(16)),console.log(i.toString(16).length),console.log(n.substring(0,64-i.toString(16).length)+i.toString(16));var a=n.substring(0,64-i.toString(16).length)+i.toString(16),o=String(e)+String(a);console.log(o),Laya.Tween.to(this._boxWaiting,{alpha:1},500,null),Ajax.callNet(GameConfig.RPC_URL,{jsonrpc:"2.0",method:"personal_unlockAccount",params:[localStorage.getItem("uuid"),"",null],id:67},"POST",null,function(t){console.info(t),Ajax.callNet(GameConfig.RPC_URL,{jsonrpc:"2.0",method:"eth_sendTransaction",params:[{from:localStorage.getItem("uuid"),to:GameConfig.RPC_ADDRESS,data:"0x95bf05a4"+o}],id:67},"POST",null,function(t){console.info(t);var n=JSON.parse(t);Laya.timer.loop(1e4,this,function(){Ajax.callNet(GameConfig.RPC_URL,{jsonrpc:"2.0",method:"eth_getTransactionReceipt",params:[n.result],id:67},"POST",null,function(t){console.info(t);JSON.parse(t).result&&(Laya.timer.clearAll(this),this._boxNormal.mouseEnabled=!0,this._boxWaiting.visible=!1,this.removeSelf(),Dispatcher.dispatch("updateBag"))}.bind(this))})}.bind(this))}.bind(this))}},n}(ui.cardPackage.SellCardUI);