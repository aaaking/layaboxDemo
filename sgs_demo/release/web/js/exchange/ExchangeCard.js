var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)n.hasOwnProperty(a)&&(t[a]=n[a])};return function(n,a){function e(){this.constructor=n}t(n,a),n.prototype=null===a?Object.create(a):(e.prototype=a.prototype,new e)}}(),ExchangeCard=function(t){function n(){var n=t.call(this)||this;return n._imgName=new Laya.Image,n._imgName.pos(14,70),n.addChild(n._imgName),n._labCount=new Laya.Label,n._labCount.right=20,n._labCount.bottom=20,n._labCount.fontSize=30,n._labCount.color="#ffffff",n._labCount.stroke=5,n._labCount.strokeColor="0000000",n.addChild(n._labCount),n._btnBuy=new Laya.Button("menu/btn_buy.png"),n._btnBuy.stateNum=1,n.addChild(n._btnBuy),n._btnBuy.centerX=0,n._btnBuy.y=282,n.height=360,n._labPrice=new Laya.Label("200"),n._btnBuy.addChild(n._labPrice),n._labPrice.color="#ffffff",n._labPrice.fontSize=20,n._labPrice.stroke=2,n._labPrice.strokeColor="#000000",n._labPrice.pos(80,30),n._btnBuy.on(Laya.Event.CLICK,n,n.buyCard),n}return __extends(n,t),n.prototype.updata=function(){t.prototype.updata.call(this),this._icon.skin="cards/"+this.dataSource.cfg.icon+".png",this._imgName.visible=!0,this._imgName.skin="cardsname/"+this.dataSource.cfg.icon+".png",this._labPrice.text=this.dataSource.price,this.dataSource.isself?(this._btnBuy.skin="menu/btn_cancel.png",this._labPrice.visible=!1):this._btnBuy.skin="menu/btn_buy.png"},n.prototype.buyCard=function(){var t="0000000000000000000000000000000000000000000000000000000000000000".substring(0,64-this.dataSource.id.toString(16).length)+this.dataSource.id.toString(16);Ajax.callNet(GameConfig.RPC_URL,{jsonrpc:"2.0",method:"personal_unlockAccount",params:[localStorage.getItem("uuid"),"",null],id:67},"POST",null,function(n){console.info(n),Ajax.callNet(GameConfig.RPC_URL,{jsonrpc:"2.0",method:"eth_sendTransaction",params:[{from:localStorage.getItem("uuid"),to:GameConfig.RPC_ADDRESS,data:"0xc70f5eaa"+t,value:"0x"+parseInt(this.dataSource.price).toString(16)}],id:67},"POST",null,function(t){console.info(t);var n=JSON.parse(t);Laya.timer.loop(1e4,this,function(){Ajax.callNet(GameConfig.RPC_URL,{jsonrpc:"2.0",method:"eth_getTransactionReceipt",params:[n.result],id:67},"POST",null,function(t){console.info(t);JSON.parse(t).result&&(Laya.timer.clearAll(this),Dispatcher.dispatch("updateInfo"))}.bind(this))})}.bind(this))}.bind(this))},n}(Card);